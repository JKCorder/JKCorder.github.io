<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>3 Logistic regression | Political Science and Applied Statistics using R</title>
<meta name="author" content="J.K. Corder">
<meta name="description" content="3.1 The linear probability model A number of applications in political science involve dependent variables that are binary: political behavior (vote / don’t vote), judicial politics (affirm /...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="3 Logistic regression | Political Science and Applied Statistics using R">
<meta property="og:type" content="book">
<meta property="og:description" content="3.1 The linear probability model A number of applications in political science involve dependent variables that are binary: political behavior (vote / don’t vote), judicial politics (affirm /...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="3 Logistic regression | Political Science and Applied Statistics using R">
<meta name="twitter:description" content="3.1 The linear probability model A number of applications in political science involve dependent variables that are binary: political behavior (vote / don’t vote), judicial politics (affirm /...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Political Science and Applied Statistics using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="why-math-why-r.html"><span class="header-section-number">1</span> Why math? Why R?</a></li>
<li><a class="" href="regression-review-and-assumptions.html"><span class="header-section-number">2</span> Regression: review and assumptions</a></li>
<li><a class="active" href="logistic-regression.html"><span class="header-section-number">3</span> Logistic regression</a></li>
<li><a class="" href="using-interaction-terms.html"><span class="header-section-number">4</span> Using interaction terms</a></li>
<li><a class="" href="working-with-time-series.html"><span class="header-section-number">5</span> Working with time series</a></li>
<li><a class="" href="dynamic-models-1.html"><span class="header-section-number">6</span> Dynamic Models</a></li>
<li><a class="" href="working-with-panel-data.html"><span class="header-section-number">7</span> Working with panel data</a></li>
<li><a class="" href="dynamics-panel-models---a-brief-introduction.html"><span class="header-section-number">8</span> Dynamics panel models - a brief introduction</a></li>
<li><a class="" href="counts.html"><span class="header-section-number">9</span> Counts</a></li>
<li><a class="" href="duration-models.html"><span class="header-section-number">10</span> Duration models</a></li>
<li><a class="" href="references.html"><span class="header-section-number">11</span> References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="using-the-american-national-election-study.html">Using the American National Election Study</a></li>
<li><a class="" href="the-harvard-dataverse.html">The Harvard Dataverse</a></li>
<li><a class="" href="replicating-when-do-politicians-grandstand.html">Replicating “When do politicians grandstand?”</a></li>
<li><a class="" href="data-models-and-evidence-based-policymaking.html"><span class="header-section-number">A</span> Data, models and evidence-based policymaking</a></li>
<li><a class="" href="quasi--and-natural-experiments.html"><span class="header-section-number">B</span> Quasi- and natural experiments</a></li>
<li><a class="" href="matching.html"><span class="header-section-number">C</span> Matching</a></li>
<li><a class="" href="multilevel-and-hierarchical-models.html"><span class="header-section-number">D</span> Multilevel and hierarchical models</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="logistic-regression" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h1>
<div id="the-linear-probability-model" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> The linear probability model<a class="anchor" aria-label="anchor" href="#the-linear-probability-model"><i class="fas fa-link"></i></a>
</h2>
<p>A number of applications in political science involve dependent variables that are binary: political behavior (vote / don’t vote), judicial politics (affirm / reverse), and the study of Congress (yes / no roll call vote). OLS fails when used to model a binary outcome. Specifically, one of the core assumptions of the classical linear regression model is violated. The error term is not normal with a mean of zero and variance of <span class="math inline">\(\sigma^2\)</span>.</p>
<p>To motivate the search for an alternative estimator, consider a simple model of turnout as a function of education. My expectation is that highly-educated people will be more likely to vote - costs are lower (easy to navigate registration and information hurdles) and norms about participation and engagement yield a strong payoff in terms of fulfilling civic duty. Exactly how strong is this effect? And, below, how strong relative to other factors like income, race or gender?</p>
<div id="an-example-turnout-as-a-function-of-education-1992" class="section level3 unnumbered">
<h3>An example: turnout as a function of education, 1992<a class="anchor" aria-label="anchor" href="#an-example-turnout-as-a-function-of-education-1992"><i class="fas fa-link"></i></a>
</h3>
<p>We could rely on a simple linear probability model to test the impact of education. We could estimate the coefficients with OLS using the <code>lm</code> function. The table is printed with <code>stargazer</code>. An example using ANES data from 1992 is below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># filter to select 1992</span>
<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">anes</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">VCF0004</span><span class="op">==</span><span class="fl">1992</span><span class="op">)</span>
<span class="co"># estimate a linear model of turnout as function of income</span>
<span class="co"># na.action=na.exclude instructs R</span>
<span class="co"># to ignore any observations with missing values</span>
<span class="va">model1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">~</span><span class="va">education</span>, data<span class="op">=</span><span class="va">temp</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span>
<span class="co"># view the model info</span>
<span class="fu">stargazer</span><span class="op">(</span><span class="va">model1</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>,
          covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Education"</span>, <span class="st">"Constant"</span><span class="op">)</span>,
          dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Turnout"</span><span class="op">)</span>,
          title<span class="op">=</span><span class="st">"**Table 1.  Turnout as a function of education, linear probability model**"</span>,
          notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append <span class="op">=</span> <span class="cn">FALSE</span>,
          star.cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 1. Turnout as a function of education, linear probability model</strong></strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Turnout
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Education
</td>
<td>
0.079<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.438<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.022)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
2,197
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.102
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.102
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
0.409 (df = 2195)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
249.253<sup>**</sup> (df = 1; 2195)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="2" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<p><br>
You can see that turnout is higher for people who are highly educated - the slope coefficient is positive.</p>
<p>Specifically, someone who has a grade school education (1) is much less likely to report they voted than someone with an advanced degree (7). We can use the constant and the slope to calculate the predicted probability for both groups.</p>
<p>For grade school education, the calculation is:</p>
<p><span class="math display">\[p=0.438 + (0.079*1) = 0.517\]</span></p>
<p>For advanced degrees, the calculation is:</p>
<p><span class="math display">\[p=0.438 + (0.079*7) = 0.991\]</span></p>
<p>So why not use the linear model?</p>
</div>
<div id="challenges-or-limitations" class="section level3 unnumbered">
<h3>Challenges or limitations<a class="anchor" aria-label="anchor" href="#challenges-or-limitations"><i class="fas fa-link"></i></a>
</h3>
<p>One problem that can happen with this type of model is we could have an expected probability over 100%, which makes no sense. A second problem is revealed by a simple inspection of the residuals. The residuals are distributed in two clusters - mean about +0.25 and about -0.75 (differences between the predicted values and observed outcomes of either 1 or 0). This is clearly not normally distributed.</p>
<p>The residuals are summarized in Figure 1. I used the <code>tidy</code> function from the <strong>broom</strong> package to pass the errors created with <code>residuals</code> to <code>ggplot</code> to produce the figure.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Collect the residuals in a dataframe</span>
<span class="va">errors</span><span class="op">&lt;-</span><span class="fu">tidy</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">errors</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span>bins<span class="op">=</span><span class="fl">35</span>, col<span class="op">=</span><span class="st">"black"</span>, fill<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">labs</span><span class="op">(</span>y<span class="op">=</span><span class="st">"Frequency"</span>, x<span class="op">=</span><span class="st">"Residual"</span><span class="op">)</span> <span class="op">+</span> 
 <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 1. Residuals from a linear probability model"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/figure1-1.png" width="672"></div>
</div>
</div>
<div id="logistic-regression-or-logit" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Logistic regression or logit<a class="anchor" aria-label="anchor" href="#logistic-regression-or-logit"><i class="fas fa-link"></i></a>
</h2>
<p>In order to overcome these problem, we use logistic regression, rather than OLS, when our dependent variable only takes two values.</p>
<p>Using a dummy variable as a dependent variable requires you to think of the response (observed as “vote” or “abstain,” “Republican” or “Democrat,” “Incumbent” or ’Challenger”) as a probability. When you observe the outcome, you know that an individual voted with probability of 1.00 or abstained with a probability of 1.00.</p>
<p>The day before the election, you could describe the probability that someone will vote or abstain as a probability: there is an 80% chance that this respondent will vote in the election tomorrow. Logistic regression estimates the unobserved probability that someone votes or does not vote, based on the observed data on voting and nonvoting for a group of people. When you group together 100 people each with an 80 percent chance of voting, then you should observe 80 voters.</p>
<div id="using-a-table-to-understand-the-link-between-education-and-turnout" class="section level3 unnumbered">
<h3>Using a table to understand the link between education and turnout<a class="anchor" aria-label="anchor" href="#using-a-table-to-understand-the-link-between-education-and-turnout"><i class="fas fa-link"></i></a>
</h3>
<p>Persisting with the relationship between education and turnout, I produced three tables below that summarize the bivariate distribution of education and turnout using the 1992 ANES. The first table just reports the proportions zero and one for each education category. The second table reports actual observed numbers of zeroes and ones in each category. Table 3 neatly summarizes the probability of turnout in each category.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="logistic-regression.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce and print the simple table of turnout by education level</span></span>
<span id="cb16-2"><a href="logistic-regression.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(temp<span class="sc">$</span>education, temp<span class="sc">$</span>turnout), <span class="at">margin=</span><span class="dv">1</span>),<span class="dv">2</span>)</span>
<span id="cb16-3"><a href="logistic-regression.html#cb16-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb16-4"><a href="logistic-regression.html#cb16-4" aria-hidden="true" tabindex="-1"></a>       <span class="dv">0</span>    <span class="dv">1</span></span>
<span id="cb16-5"><a href="logistic-regression.html#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="fl">0.45</span> <span class="fl">0.55</span></span>
<span id="cb16-6"><a href="logistic-regression.html#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span> <span class="fl">0.52</span> <span class="fl">0.48</span></span>
<span id="cb16-7"><a href="logistic-regression.html#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span> <span class="fl">0.29</span> <span class="fl">0.71</span></span>
<span id="cb16-8"><a href="logistic-regression.html#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span> <span class="fl">0.16</span> <span class="fl">0.84</span></span>
<span id="cb16-9"><a href="logistic-regression.html#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span> <span class="fl">0.09</span> <span class="fl">0.91</span></span>
<span id="cb16-10"><a href="logistic-regression.html#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span> <span class="fl">0.04</span> <span class="fl">0.96</span></span>
<span id="cb16-11"><a href="logistic-regression.html#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="logistic-regression.html#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># And here are the numbers for each group - we will use these below</span></span>
<span id="cb16-13"><a href="logistic-regression.html#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(temp<span class="sc">$</span>education, temp<span class="sc">$</span>turnout)</span>
<span id="cb16-14"><a href="logistic-regression.html#cb16-14" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb16-15"><a href="logistic-regression.html#cb16-15" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>   <span class="dv">1</span></span>
<span id="cb16-16"><a href="logistic-regression.html#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>  <span class="dv">75</span>  <span class="dv">91</span></span>
<span id="cb16-17"><a href="logistic-regression.html#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span> <span class="dv">133</span> <span class="dv">123</span></span>
<span id="cb16-18"><a href="logistic-regression.html#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">3</span> <span class="dv">211</span> <span class="dv">527</span></span>
<span id="cb16-19"><a href="logistic-regression.html#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">5</span>  <span class="dv">85</span> <span class="dv">434</span></span>
<span id="cb16-20"><a href="logistic-regression.html#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">6</span>  <span class="dv">31</span> <span class="dv">323</span></span>
<span id="cb16-21"><a href="logistic-regression.html#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">7</span>   <span class="dv">7</span> <span class="dv">157</span></span>
<span id="cb16-22"><a href="logistic-regression.html#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="logistic-regression.html#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce the table using group_by</span></span>
<span id="cb16-24"><a href="logistic-regression.html#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="co"># to get the probability and the number</span></span>
<span id="cb16-25"><a href="logistic-regression.html#cb16-25" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span> temp <span class="sc">%&gt;%</span>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(turnout), <span class="sc">!</span><span class="fu">is.na</span>(education)) <span class="sc">%&gt;%</span></span>
<span id="cb16-26"><a href="logistic-regression.html#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(education) <span class="sc">%&gt;%</span></span>
<span id="cb16-27"><a href="logistic-regression.html#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">turnout =</span> <span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(turnout, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb16-28"><a href="logistic-regression.html#cb16-28" aria-hidden="true" tabindex="-1"></a>            <span class="at">count=</span><span class="fu">n</span>(),</span>
<span id="cb16-29"><a href="logistic-regression.html#cb16-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb16-30"><a href="logistic-regression.html#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce a table with the kable function and</span></span>
<span id="cb16-31"><a href="logistic-regression.html#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># include options to customize column names,</span></span>
<span id="cb16-32"><a href="logistic-regression.html#cb16-32" aria-hidden="true" tabindex="-1"></a><span class="co"># limit to 1 digit after the decimal point,</span></span>
<span id="cb16-33"><a href="logistic-regression.html#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="co"># include a caption so the table is labeled</span></span>
<span id="cb16-34"><a href="logistic-regression.html#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(d,</span>
<span id="cb16-35"><a href="logistic-regression.html#cb16-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">1</span>, </span>
<span id="cb16-36"><a href="logistic-regression.html#cb16-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">"**Table 2. Turnout, by education, 1992 US presidential election**"</span>,</span>
<span id="cb16-37"><a href="logistic-regression.html#cb16-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">col.names=</span><span class="fu">c</span>(<span class="st">"Education"</span>, <span class="st">"Turnout"</span>, <span class="st">"Count"</span>)) </span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:table1"></span><strong>Table 2. Turnout, by education, 1992 US presidential election</strong>
</caption>
<thead><tr class="header">
<th align="right">Education</th>
<th align="right">Turnout</th>
<th align="right">Count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">54.8</td>
<td align="right">166</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">48.0</td>
<td align="right">256</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">71.4</td>
<td align="right">738</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">83.6</td>
<td align="right">519</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">91.2</td>
<td align="right">354</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">95.7</td>
<td align="right">164</td>
</tr>
</tbody>
</table></div>
<p>You can see that the actual probability of turnout in the sample is 55% for those with grade-school education and 96% for the highest level of education. The linear probability model, above, slightly under-estimated the probability of turnout for the lowest level of education and over-estimated the probability of turnout for the highest level of education.</p>
</div>
<div id="using-logistic-regression-to-understand-turnout" class="section level3 unnumbered">
<h3>Using logistic regression to understand turnout<a class="anchor" aria-label="anchor" href="#using-logistic-regression-to-understand-turnout"><i class="fas fa-link"></i></a>
</h3>
<p>Before unpacking how logistic regression works, we can take a look at an example. We use <code>glm</code> function to implement logistic regression. Using the command and interpreting the coefficients are very similar to OLS regression. The coefficients tell you whether the relationship is positive or negative. The p-value indicates statistical significance. In R, the goodness of fit test statistic reported is the AIC or <em>Akaike’s Information Criteria</em>. We will discuss that test below.</p>
<p>We are using <code>glm</code> to estimate a logit model, but this a function that helps us estimate a much broader range of models that you will learn later in the term.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># estimate the logit model</span>
<span class="co"># We know this a logistic regression since:  family=binomial(link = "logit")</span>
<span class="va">model2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">~</span><span class="va">education</span>, data<span class="op">=</span><span class="va">temp</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span>
<span class="fu">stargazer</span><span class="op">(</span><span class="va">model2</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>,
          covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Education"</span>, <span class="st">"Constant"</span><span class="op">)</span>,
          dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Turnout"</span><span class="op">)</span>,
          title<span class="op">=</span><span class="st">"**Table 3.  Turnout as a function of education, logit**"</span>,
          notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append <span class="op">=</span> <span class="cn">FALSE</span>,
          star.cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 3. Turnout as a function of education, logit</strong></strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Turnout
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Education
</td>
<td>
0.479<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.034)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.623<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.123)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
2,197
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-1,108.571
</td>
</tr>
<tr>
<td style="text-align:left">
AIC
</td>
<td>
2,221.143
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="2" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<p><br>
The output looks familiar - the table includes coefficients, standard errors, and goodness-of-fit statistics. You can see that, as expected, the key coefficient is positive - highly educated people are more likely to turn out.</p>
<p>(Note that I did not use survey weights in this example. You can use survey weights with <code>glm</code> and we will use those in the assignments since later versions of the ANES do include weights)</p>
</div>
</div>
<div id="logistic-regression-the-details" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Logistic regression: the details<a class="anchor" aria-label="anchor" href="#logistic-regression-the-details"><i class="fas fa-link"></i></a>
</h2>
<p>Logistic regression differs from OLS in several ways.</p>
<ul>
<li>the model is nonlinear: the coefficients are on the scale of the logit</li>
<li>the parameters are estimated via maximum likelihood</li>
<li>the goodness-of-fit test statistics are based on the likelihood</li>
<li>effects of one predictor are conditional on all others</li>
</ul>
<div id="the-model-is-nonlinear" class="section level3 unnumbered">
<h3>The model is nonlinear<a class="anchor" aria-label="anchor" href="#the-model-is-nonlinear"><i class="fas fa-link"></i></a>
</h3>
<p>First, the logit estimator is nonlinear. The scale of estimation (and the coefficients reported in the table) are not probabilities but on the scale of the logit.</p>
<p>The logit transforms unobserved probabilities (which are bounded between 0 and 1) to an unbounded scale centered at 0.0. The formula for the transformation is</p>
<p><span class="math display">\[logit(p)=\ln(p/(1-p))\]</span></p>
<p>where <span class="math inline">\(p\)</span> is a probability, between 0 and 1.</p>
<p>If <span class="math inline">\(p\)</span>=0.5 then the logit=0.0</p>
<p>If <span class="math inline">\(p\)</span>=.05 then the logit is about -3.00</p>
<p>If <span class="math inline">\(p\)</span>=0.95. then the logit is about 3.00</p>
<p>Coefficients reported in the table indicate how much a one unit increase in X affects the logit of Y. So, above, a one unit change in education produces a positive increase of 0.48 in the logit of Y.</p>
<p>Translating the change in the logit to a change in probability is not easy. The formula for the transformation is:</p>
<p><span class="math display">\[prob(Y)=\frac{1}{(1+exp^{(-(logit)})}\]</span></p>
<p>The figure below maps values of the logistic on to the [0,1] probability interval</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Generate x - a random uniform number from -3.5 to 3.5</span>
<span class="co"># I do this by taking 200 draws on the 0 to 7 and subtracting each from 3.5</span>
<span class="va">x</span><span class="op">&lt;-</span><span class="fl">3.5</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">0</span>,<span class="fl">7</span><span class="op">)</span>
<span class="co"># Generate the probability y associated with logit x</span>
<span class="va">y</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="co"># PUt x and y in a data frame</span>
<span class="va">data</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span>
<span class="co"># generate the figure</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_segment</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="fl">0</span>,xend<span class="op">=</span><span class="fl">0</span>,y<span class="op">=</span><span class="fl">0</span>,yend<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_hline</span><span class="op">(</span>yintercept<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">1.0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span><span class="st">"Value of the logit"</span> , y<span class="op">=</span><span class="st">"Probability"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>axis.line<span class="op">=</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>, axis.ticks<span class="op">=</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.0</span>,<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">0.0</span>, <span class="fl">1.5</span>, <span class="fl">3.0</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
<span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 2. The shape of the logistic distribution"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/logit-1.png" width="672"></div>
<div id="the-coefficients-are-on-the-scale-of-the-logit" class="section level4 unnumbered">
<h4>The coefficients are on the scale of the logit<a class="anchor" aria-label="anchor" href="#the-coefficients-are-on-the-scale-of-the-logit"><i class="fas fa-link"></i></a>
</h4>
<p>The logit is computed with coefficients from the linear model <span class="math inline">\(\beta_0+\beta_1X_1\)</span>. To determine how much a one unit change in education affects the probability of voting, we would compute<span class="math inline">\(\beta_0+\beta_1X_1\)</span> for education level “1” and compare that to the logit (and associated probability) for other education levels.</p>
</div>
<div id="the-effect-of-education-on-turnout" class="section level4 unnumbered">
<h4>The effect of education on turnout<a class="anchor" aria-label="anchor" href="#the-effect-of-education-on-turnout"><i class="fas fa-link"></i></a>
</h4>
<p>I used three approaches to compute and summarize predicted values from the regression. Using the <code>predict</code> function, I calculated the logit for each observed value of education. Using the formula above, I converted this logit to a probability. Finally, Using the <code>predict</code> function and designating type=“response” I calculated the predicted probability for each education level.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Calculate predicted quantities</span>

<span class="co"># calculate the predicted logit</span>
<span class="va">temp</span><span class="op">$</span><span class="va">fitted</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span>

<span class="co"># convert to probability</span>
<span class="va">temp</span><span class="op">$</span><span class="va">prob</span><span class="op">&lt;-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">temp</span><span class="op">$</span><span class="va">fitted</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Or I could grab the probability with the predict function</span>
<span class="va">temp</span><span class="op">$</span><span class="va">response</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model2</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span>


<span class="co"># Since I only have one variable, in the model I can just create a simple table</span>
<span class="va">table3</span><span class="op">&lt;-</span> <span class="va">temp</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">education</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">education</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>
    fitted   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">fitted</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
    probability     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">prob</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
    response <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">response</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>

<span class="fu">kable</span><span class="op">(</span><span class="va">table3</span>, digits<span class="op">=</span><span class="fl">3</span>, caption<span class="op">=</span><span class="st">"**Table 4. Predicted values**"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:fitted"></span><strong>Table 4. Predicted values</strong>
</caption>
<thead><tr class="header">
<th align="right">education</th>
<th align="right">fitted</th>
<th align="right">probability</th>
<th align="right">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-0.144</td>
<td align="right">0.464</td>
<td align="right">0.464</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.334</td>
<td align="right">0.583</td>
<td align="right">0.583</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.813</td>
<td align="right">0.693</td>
<td align="right">0.693</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">1.770</td>
<td align="right">0.854</td>
<td align="right">0.854</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">2.248</td>
<td align="right">0.905</td>
<td align="right">0.905</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">2.727</td>
<td align="right">0.939</td>
<td align="right">0.939</td>
</tr>
</tbody>
</table></div>
<p>The predicted logit for someone with a grade school education is:</p>
<p><span class="math display">\[logit=-0.144= -0.623+(1*0.479)\]</span></p>
<p>This translates into a <span class="math inline">\(p\)</span> of .464 or a probability of 46.4%. Note that this still underestimates the probability of voting for in the sample for those with a grade school education. This is mainly due to something you may have noticed in the tables above: people in category 2 actually turnout at a higher rate than people in category 1, so even a simple nonlinear model will not capture this.</p>
<p>Figure 4 summarizes the link between education and turnout that is implied by our model - moving up the education scale is associated with positive gains in turnout, with the largest gains between category 1 and 2 and the small gains between category 6 and 7. We would say that the <em>marginal effect</em> of education diminishes as education increases (you may have heard that phrase “diminishing marginal returns”).</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#This plot just generates a figure from the probabilities in Table 3</span>
<span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">table3</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">education</span>, y <span class="op">=</span> <span class="va">response</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span><span class="st">"Education level"</span> , y<span class="op">=</span><span class="st">"Probability of turnout"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span>
<span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 3. Predicted turnout, as a function of education"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/fit_fig-1.png" width="672"></div>
</div>
</div>
<div id="parameters-are-estimated-via-maximum-likelihood" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Parameters are estimated via maximum likelihood<a class="anchor" aria-label="anchor" href="#parameters-are-estimated-via-maximum-likelihood"><i class="fas fa-link"></i></a>
</h3>
<p>The second major difference between logistic regression and OLS is that the parameters are estimated via what is known as a <em>maximum likelihood estimator</em>. We rely on a likelihood function - what is the likelihood that the data (a “0” or “1”) are observed given the proposed parameters of the model? The proposed parameters are often designated as <span class="math inline">\(\Theta\)</span>. The likelihood function is then maximized - what parameters of the model generate the highest likelihood for observing the ANES sample outcomes? While the calculation is complex, the intuition is straightforward - we want to choose the parameters for our model that make it most likely that we would observe the outcomes in the sample given our choice of model.</p>
<p>How do we calculate the likelihood? Consider each observation that has a 40% chance of voting (<span class="math inline">\(p\)</span>=0.40): if we observe a “1” we calculate the likelihood for that observation as 0.40 (<span class="math inline">\(p\)</span>). If we observe a “0” we calculate the likelihood for that observations as 0.60 (1-<span class="math inline">\(p\)</span>). So every observation contributes to the likelihood.</p>
<p>Given the predicted probability for each unique observation and the observed 0 or 1, we can multiply all of the likelihoods together to get a number. We want to maximize that number - use parameter estimates that return the highest possible value.</p>
<p><span class="math display">\[p(y\mid\Theta)=\prod_{i=1}^Np(y_i\mid\Theta)\]</span></p>
<p>Technically, this is accomplished by taking the log of the likelihood function and maximizing this log. Why the log? The log of the product of the likelihoods is equal to the sum of the logs of each likelihood, so calculation is much easier and feasible with the log likelihoods. The log of 1 is zero - and the log of a very small probability is -5, so the sum of the logs will be some large negative number. And closer to zero is better.</p>
<p><span class="math display">\[\ln p(y\mid\Theta)=\sum_{i=1}^Nlnp(y_i\mid\Theta)\]</span></p>
<p>To walk through the details, we will stick with the numbers on education. Looking at the table above, we have 166 people with grade-school educations - and the predicted probability of turnout for this level of education is 0.464. We observe 75 “0” and 91 “1.” So that group’s contribution to the likelihood would be:</p>
<p><span class="math display">\[log((1.0-0.464)^{75} + log(0.464)^{91}\]</span></p>
<p>Those numbers add up to -116.6. If we calculate this pair of numbers for each of the 7 education categories we would end up with a log-likelihood of -1108.6. There is not another combination of parameters (intercept, slope) that would produce a better (closer to zero) log-likelihood.</p>
<p>The solution is obtained via calculus - we can determine the equation for the likelihood function, take the first derivative with respect to our parameters (<span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>), set it to zero (maximum or peak of the curve) and solve for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>. We will discuss this estimation strategy in more detail in later chapters.</p>
</div>
<div id="the-goodness-of-fit-test-statistics-are-based-on-the-likelihood" class="section level3 unnumbered">
<h3>The goodness-of-fit test statistics are based on the likelihood<a class="anchor" aria-label="anchor" href="#the-goodness-of-fit-test-statistics-are-based-on-the-likelihood"><i class="fas fa-link"></i></a>
</h3>
<p>A third difference from OLS is how we evaluate goodness-of-fit. To evaluate model fit, we can compare the likelihood of a simple naive model that treats every observation as having the same probability of turnout (a constant) to the likelihood of a 3-variable model, adding income and age to our simply model of turnout as a function of education. The statistical test to compare likelihood is an <em>LR test</em>. An example is below. I estimate the constant-only model, the education only model and compare the log-likelihood with the 3-variable model.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># I am recreating the 1992 dataset to sweep out any observations with any missing data before I re-estimate the models so that I have the same number of observations in each regression.</span>

<span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">anes</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">VCF0004</span><span class="op">==</span><span class="fl">1992</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">education</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">age</span><span class="op">)</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">)</span><span class="op">)</span>

<span class="co"># first estimate the new model with education, age and income as predictors</span>
<span class="va">model3</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">~</span><span class="va">education</span><span class="op">+</span><span class="va">age</span><span class="op">+</span><span class="va">income</span>, data<span class="op">=</span><span class="va">temp</span>, na.action<span class="op">=</span><span class="va">na.exclude</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">"logit"</span><span class="op">)</span><span class="op">)</span>

<span class="co"># estimate the constant only model</span>
<span class="va">model0</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">~</span><span class="fl">1</span>, data<span class="op">=</span><span class="va">temp</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">model0</span><span class="op">)</span>
<span class="st">'log Lik.'</span> <span class="op">-</span><span class="fl">1123.883</span> <span class="op">(</span>df<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># estimate education only with the trimmed data</span>
<span class="va">model2a</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">turnout</span><span class="op">~</span><span class="va">education</span>, data<span class="op">=</span><span class="va">temp</span>, family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span>, na.action<span class="op">=</span><span class="va">na.exclude</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">model2a</span><span class="op">)</span>
<span class="st">'log Lik.'</span> <span class="op">-</span><span class="fl">1012.031</span> <span class="op">(</span>df<span class="op">=</span><span class="fl">2</span><span class="op">)</span>

<span class="co"># Check the likelihood for the multivariate model</span>

<span class="fu"><a href="https://rdrr.io/r/stats/logLik.html">logLik</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span>
<span class="st">'log Lik.'</span> <span class="op">-</span><span class="fl">920.4862</span> <span class="op">(</span>df<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>knitr.kable.NA <span class="op">=</span> <span class="st">''</span><span class="op">)</span>
<span class="co">#use the lrtest function from the lmtest package to generate the statistics</span>
<span class="va">gfstats</span><span class="op">&lt;-</span><span class="fu">tidy</span><span class="op">(</span><span class="fu">lrtest</span><span class="op">(</span><span class="va">model0</span>, <span class="va">model3</span><span class="op">)</span><span class="op">)</span>
<span class="va">gfstats</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.03f"</span>, <span class="va">gfstats</span><span class="op">$</span><span class="va">p.value</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>
<span class="fu">kable</span><span class="op">(</span><span class="va">gfstats</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, col.names<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"df"</span>, <span class="st">"Log-likelihood"</span>, <span class="st">"df"</span>, <span class="st">"chi-square"</span>, <span class="st">"p"</span><span class="op">)</span>, caption<span class="op">=</span><span class="st">"**Table 5. Likelihood ratio (LR) test**"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:lrtests"></span><strong>Table 5. Likelihood ratio (LR) test</strong>
</caption>
<thead><tr class="header">
<th align="right">df</th>
<th align="right">Log-likelihood</th>
<th align="right">df</th>
<th align="right">chi-square</th>
<th align="left">p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">-1123.88</td>
<td align="right"></td>
<td align="right"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">-920.49</td>
<td align="right">3</td>
<td align="right">406.79</td>
<td align="left">0.000</td>
</tr>
</tbody>
</table></div>
<p>You can see that log-likelihood gets closer to zero from -1124 to -1012 to -920 - so this is suggesting an improved fit. Is the improvement in the log-likehood statistically significant? The LR is indicating yes, significant at <span class="math inline">\(p&lt;0.001\)</span>.</p>
<p>The formula for the LR test is:</p>
<p><span class="math display">\[LR = -2 ln\left(\frac{{L}(m_0)}{{L}(m_3))}\right) = 2(logL(m_3)-logL(m_0))\]</span>
The log likelihood of the constant only model is -1123,88 (<span class="math inline">\(L(m_0)\)</span>)</p>
<p>The log likelihood of the full model is -920.49. (<span class="math inline">\(L(m_3)\)</span>)</p>
<p><span class="math display">\[ 2*(-920.49 - -1123.88) =  406.78 \]</span></p>
<div id="what-is-pseudo-r-squared" class="section level4 unnumbered">
<h4>What is pseudo R-squared?<a class="anchor" aria-label="anchor" href="#what-is-pseudo-r-squared"><i class="fas fa-link"></i></a>
</h4>
<p>I don’t think pseudo R-squared is a particularly useful summary of model fit, but it is pervasive in the literature. The pseudo R-squared is a function of the model likelihood, <span class="math inline">\(L(m)\)</span></p>
<p><span class="math display">\[pseudo{\text -}R^2 = 1-((L(m_0)/L(m_3))\]</span></p>
<p>where <span class="math inline">\(L(m_0)\)</span> is the constant only log-likelihood and <span class="math inline">\(L(m_3)\)</span> is the full model log likelihood. This is a variant of the likelihood ratio test.</p>
<p>Note: All the constant represents in the constant only model is the logit of the probability of turnout. The probability of overall turnout:</p>
<p><span class="math display">\[p=1/(1+exp(-1.1444)) = 0.758 \]</span></p>
<p>The log likelihood of the constant only model is -1123,88 (<span class="math inline">\(L(m_0)\)</span>)</p>
<p>The log likelihood of the full model is -920.49. (<span class="math inline">\(L(m_3)\)</span>)</p>
<p>The formula for the pseudo R-squared is:</p>
<p><span class="math display">\[ 1-(L(m_3)/L(m_0)=1-(-920.49/-1123.88)=0.180 \]</span></p>
<p>Why might this statistic be undesirable as an absolute goodness of fit summary? The only way that the pseudo R-squared can approach 1.0 is if <span class="math inline">\(L_m*\)</span> approaches zero. This would mean that we have a predicted value of 1.0 (an extremely high logit) for all respondents that vote and a predicted value of 0.0 (an extremely low logit) for all respondents that do not vote. This is unlikely to be observed in practice, so pseudo r-squared are likely to be fairly low. The statistic remains, like the regular R-squared, a useful comparison across models.</p>
</div>
<div id="other-measures-of-model-fit" class="section level4 unnumbered">
<h4>Other measures of model fit<a class="anchor" aria-label="anchor" href="#other-measures-of-model-fit"><i class="fas fa-link"></i></a>
</h4>
<p>You may see two measures of model fit that are reported in the maximum likelihood framework. The Bayesian Information Criteria (<em>BIC</em>) and Akaike’s Information Criteria (or “An” Information Criteria). Both <em>AIC</em> and BIC are simple functions of the log of the likelihood function evaluated at a particular set of parameter estimates.</p>
<p><span class="math display">\[AIC = −N * L(m_*)+2k\]</span></p>
<p><span class="math display">\[BIC = −2 *L(m_*)+k*\log N\]</span></p>
<p>N is the number of observations, k is the number of model parameters, and <span class="math inline">\(L_(m_*)\)</span> is the log likelihood.</p>
<p>The model with the lowest IC is the best fit. There is a set of literature that documents the circumstances under which each information criterion is appropriate but you will see them used interchangeably in political science work and typically both criteria point to the same model specification as the best fit.</p>
</div>
</div>
<div id="effects-of-one-predictor-are-conditional-on-all-others" class="section level3 unnumbered">
<h3>Effects of one predictor are conditional on all others<a class="anchor" aria-label="anchor" href="#effects-of-one-predictor-are-conditional-on-all-others"><i class="fas fa-link"></i></a>
</h3>
<p>Another feature of logistic regression that requires some care - but it also very useful - is that the marginal effect of a variable depends on the value of all other variables.</p>
<p>To consider how this works, we will estimate a model that use the estimates from our model with 3 predictors - age, education and income. Using multiple predictors has a couple of advantages. We can isolate the effect of each variable (we will talk more about this logic - controlled comparison - next week). With logit, we can also pick up interactions in this way - in other words, we saw above that the marginal effect of education diminished for higher levels of education. Does the marginal effect of education also diminish for people who are older or high income? We talk more about these <em>interaction effects</em> in Chapter 4.</p>
<p>The estimates from the 3-variable model are reported in Table 6. Each of the variables matters in the expected way: older, more affluent and highly-educated respondents are more likely to report they voted. If you compare the AIC in the model below with the other tables, you can see that this model fits the data better than education alone.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">stargazer</span><span class="op">(</span><span class="va">model3</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>,
          covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Education"</span>, <span class="st">"Age"</span>,<span class="st">"Income"</span>, <span class="st">"Constant"</span><span class="op">)</span>,
          dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Turnout"</span><span class="op">)</span>,
          title<span class="op">=</span><span class="st">"**Table 6.  Turnout as a function of education, age and income**"</span>,
          notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append <span class="op">=</span> <span class="cn">FALSE</span>,
          star.cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 6. Turnout as a function of education, age and income</strong></strong>
</caption>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Turnout
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Education
</td>
<td>
0.528<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.043)
</td>
</tr>
<tr>
<td style="text-align:left">
Age
</td>
<td>
0.040<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.004)
</td>
</tr>
<tr>
<td style="text-align:left">
Income
</td>
<td>
0.418<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.056)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-3.646<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.281)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
2,033
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-920.486
</td>
</tr>
<tr>
<td style="text-align:left">
AIC
</td>
<td>
1,848.972
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="2" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<p><br>
The <strong>margins</strong> package is useful as we interpret this regression. The ‘margins’ function calculates, by default, the <em>Average Marginal Effect</em> for each variable in the model - this is the average of the marginal effects observed over the combinations of age, education, and income observed in the sample data. The marginal effect is the impact of a one-unit change in X on the probability of Y. In the table below,</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># In this chunk, we use the margins command to learn the marginal effects of each predictor</span>
<span class="va">m</span><span class="op">&lt;-</span><span class="fu">margins</span><span class="op">(</span><span class="va">model3</span><span class="op">)</span>
<span class="co"># This summary simply reports the Average Marginal Effect</span>
<span class="co"># Marginal just means the effect of a one unit change in X</span>
<span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span>, caption<span class="op">=</span><span class="st">"**Table 7. Average marginal effects (AME)**"</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:unnamed-chunk-1"></span><strong>Table 7. Average marginal effects (AME)</strong>
</caption>
<thead><tr class="header">
<th align="left">factor</th>
<th align="right">AME</th>
<th align="right">SE</th>
<th align="right">z</th>
<th align="right">p</th>
<th align="right">lower</th>
<th align="right">upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">age</td>
<td align="right">0.0058859</td>
<td align="right">0.0004847</td>
<td align="right">12.142917</td>
<td align="right">0</td>
<td align="right">0.0049358</td>
<td align="right">0.0068359</td>
</tr>
<tr class="even">
<td align="left">education</td>
<td align="right">0.0776852</td>
<td align="right">0.0056624</td>
<td align="right">13.719515</td>
<td align="right">0</td>
<td align="right">0.0665871</td>
<td align="right">0.0887832</td>
</tr>
<tr class="odd">
<td align="left">income</td>
<td align="right">0.0615812</td>
<td align="right">0.0078236</td>
<td align="right">7.871198</td>
<td align="right">0</td>
<td align="right">0.0462472</td>
<td align="right">0.0769152</td>
</tr>
</tbody>
</table></div>
<p><br>
The margins package also lets you look at conditional marginal effects. Conditional marginal effects just means marginal effects at particular combinations of the other X variables. The functions evaluate the marginal effect of education conditional on education (similar to the figure above), then income followed by age. In each figure, one variable is varied along the X-axis and the others are held constant at the mean. By default, <code>cplot</code> produces a figure. I suppress the figure but keep the output and pass the numbers to <code>ggplot</code>.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">figure_3</span><span class="op">&lt;-</span><span class="fu">cplot</span><span class="op">(</span><span class="va">model3</span>, x<span class="op">=</span><span class="st">"education"</span>, dx<span class="op">=</span><span class="st">"education"</span>, what<span class="op">=</span><span class="st">"effect"</span>, draw<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">figure_3</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">xvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">yvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Education in 7 categories"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Marginal Effect of Education"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 4. Marginal effect of education, conditional on education"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/mfigures-1.png" width="672"></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"> 
<span class="va">figure_4</span><span class="op">&lt;-</span><span class="fu">cplot</span><span class="op">(</span><span class="va">model3</span>, x<span class="op">=</span><span class="st">"income"</span>, dx<span class="op">=</span><span class="st">"education"</span>, what<span class="op">=</span><span class="st">"effect"</span>, se.type<span class="op">=</span><span class="st">"shade"</span>, draw<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co"># And pass those numbers to ggplot for a better looking figure</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="va">figure_4</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">xvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">yvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Income in 5 categories"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Marginal Effect of Education"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 5. Marginal effect of education, conditional on income"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/mfigures-2.png" width="672"></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">figure_5</span><span class="op">&lt;-</span><span class="fu">cplot</span><span class="op">(</span><span class="va">model3</span>, x<span class="op">=</span><span class="st">"age"</span>, dx<span class="op">=</span><span class="st">"education"</span>, what<span class="op">=</span><span class="st">"effect"</span>, se.type<span class="op">=</span><span class="st">"shade"</span>, draw <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu">ggplot</span><span class="op">(</span><span class="va">figure_5</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">xvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lower</span>, ymax <span class="op">=</span> <span class="va">upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">yvals</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age, in years"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ylab</span><span class="op">(</span><span class="st">"Marginal Effect of Education"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">40</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">70</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu">labs</span><span class="op">(</span>caption<span class="op">=</span><span class="st">"Figure 6. Marginal effect of education, conditional on age"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="03-logistic_files/figure-html/mfigures-3.png" width="672"></div>
<p>The marginal effect of education clearly diminishes as you are highly educated, higher income or older. But if you are low-income, young, or have a low level of education, moving up one category of education will increase the probability of turnout by 0.10 (ten percent).</p>
</div>
</div>
<div id="reading-and-questions" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Reading and questions<a class="anchor" aria-label="anchor" href="#reading-and-questions"><i class="fas fa-link"></i></a>
</h2>
<div id="reading-foxlawless2004" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Reading <span class="citation"><a href="references.html#ref-foxlawless2004" role="doc-biblioref">Fox and Lawless</a> (<a href="references.html#ref-foxlawless2004" role="doc-biblioref">2004</a>)</span><a class="anchor" aria-label="anchor" href="#reading-foxlawless2004"><i class="fas fa-link"></i></a>
</h3>
<p>The article I posted on Elearning is both interesting and a good application of logistic regression. The authors surveyed a number of people who we might think of as appropriate to run for political office (highly educated professionals). The objective is to figure out why women are under-represented in political office. Are they under-represented in pipeline professions? Do they not consider running for office? If they consider it, do they take the step of running? If they run, do they win?. The focus of the article is the middle of the process - considering and running for office.</p>
<p>As you read the article, notice that Table 1 reveals that women - controlling for other factors - are less likely to run for political office. You know the logistic regression scale - so you can imagine that an effect of -0.73 is quite large.</p>
<p>The punchline is Table 4 - based on the logistic regression, controlling for all other factors in Table 3, men who consider themselves not at all qualified for office are twice as likely to consider running for office (60% of men compared to 30% of women). This is on top of the fact that men are nearly twice as likely to consider themselves “very” qualified (26% compared to 13%)!</p>
<p>Notice that this is exactly what we are doing above - what is the response when we hold all the variables at the mean, but vary gender and self-perceived qualifications?</p>
</div>
<div id="what-is-an-interaction-term-and-can-you-use-one-in-this-context" class="section level3" number="3.4.2">
<h3>
<span class="header-section-number">3.4.2</span> What is an interaction term and can you use one in this context?<a class="anchor" aria-label="anchor" href="#what-is-an-interaction-term-and-can-you-use-one-in-this-context"><i class="fas fa-link"></i></a>
</h3>
<p>There is some controversy over the need for or usefulness of interaction terms in the logit model. See <span class="citation">(<a href="references.html#ref-berry2010" role="doc-biblioref">Berry, DeMeritt, and Esarey 2010</a>)</span>, “Testing for Interaction in Binary Logit and Probit Models: Is a Product Term Essential.” The upshot of this work is that (1) you don’t need a product or interaction term to test for interaction effects and (2) you can see interaction effects if you use the margins commands to summarize predicted probabilities – for instance you could report probability of some behavior for White males, White females, African American females and African American males and learn if the effect of gender is the same for both racial groups and if the effect of race is the same for men and women. So without introducing interaction terms, you can learn if the marginal effects are conditional on other variables in the model.</p>

<!-- Run common_r first if using as a Notebook -->
<!-- Needs ANES common data file at line 21 -->
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="regression-review-and-assumptions.html"><span class="header-section-number">2</span> Regression: review and assumptions</a></div>
<div class="next"><a href="using-interaction-terms.html"><span class="header-section-number">4</span> Using interaction terms</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#logistic-regression"><span class="header-section-number">3</span> Logistic regression</a></li>
<li>
<a class="nav-link" href="#the-linear-probability-model"><span class="header-section-number">3.1</span> The linear probability model</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#an-example-turnout-as-a-function-of-education-1992">An example: turnout as a function of education, 1992</a></li>
<li><a class="nav-link" href="#challenges-or-limitations">Challenges or limitations</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#logistic-regression-or-logit"><span class="header-section-number">3.2</span> Logistic regression or logit</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#using-a-table-to-understand-the-link-between-education-and-turnout">Using a table to understand the link between education and turnout</a></li>
<li><a class="nav-link" href="#using-logistic-regression-to-understand-turnout">Using logistic regression to understand turnout</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#logistic-regression-the-details"><span class="header-section-number">3.3</span> Logistic regression: the details</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-model-is-nonlinear">The model is nonlinear</a></li>
<li><a class="nav-link" href="#parameters-are-estimated-via-maximum-likelihood"><span class="header-section-number">3.3.1</span> Parameters are estimated via maximum likelihood</a></li>
<li><a class="nav-link" href="#the-goodness-of-fit-test-statistics-are-based-on-the-likelihood">The goodness-of-fit test statistics are based on the likelihood</a></li>
<li><a class="nav-link" href="#effects-of-one-predictor-are-conditional-on-all-others">Effects of one predictor are conditional on all others</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reading-and-questions"><span class="header-section-number">3.4</span> Reading and questions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reading-foxlawless2004"><span class="header-section-number">3.4.1</span> Reading Fox and Lawless (2004)</a></li>
<li><a class="nav-link" href="#what-is-an-interaction-term-and-can-you-use-one-in-this-context"><span class="header-section-number">3.4.2</span> What is an interaction term and can you use one in this context?</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Political Science and Applied Statistics using R</strong>" was written by J.K. Corder. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
