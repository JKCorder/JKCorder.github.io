<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>8 Dynamics panel models - a brief introduction | Political Science and Applied Statistics using R</title>
<meta name="author" content="J.K. Corder">
<meta name="description" content="8.1 Plan for class We will cover four things today: Review - statistical significance - what it means and why it is important Review - using model coefficients to describe the size of effects _...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="8 Dynamics panel models - a brief introduction | Political Science and Applied Statistics using R">
<meta property="og:type" content="book">
<meta property="og:description" content="8.1 Plan for class We will cover four things today: Review - statistical significance - what it means and why it is important Review - using model coefficients to describe the size of effects _...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="8 Dynamics panel models - a brief introduction | Political Science and Applied Statistics using R">
<meta name="twitter:description" content="8.1 Plan for class We will cover four things today: Review - statistical significance - what it means and why it is important Review - using model coefficients to describe the size of effects _...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Political Science and Applied Statistics using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">About</a></li>
<li><a class="" href="why-math-why-r.html"><span class="header-section-number">1</span> Why math? Why R?</a></li>
<li><a class="" href="regression-review-and-assumptions.html"><span class="header-section-number">2</span> Regression: review and assumptions</a></li>
<li><a class="" href="logistic-regression.html"><span class="header-section-number">3</span> Logistic regression</a></li>
<li><a class="" href="using-interaction-terms.html"><span class="header-section-number">4</span> Using interaction terms</a></li>
<li><a class="" href="working-with-time-series.html"><span class="header-section-number">5</span> Working with time series</a></li>
<li><a class="" href="dynamic-models-1.html"><span class="header-section-number">6</span> Dynamic Models</a></li>
<li><a class="" href="working-with-panel-data.html"><span class="header-section-number">7</span> Working with panel data</a></li>
<li><a class="active" href="dynamics-panel-models---a-brief-introduction.html"><span class="header-section-number">8</span> Dynamics panel models - a brief introduction</a></li>
<li><a class="" href="counts.html"><span class="header-section-number">9</span> Counts</a></li>
<li><a class="" href="duration-models.html"><span class="header-section-number">10</span> Duration models</a></li>
<li><a class="" href="references.html"><span class="header-section-number">11</span> References</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="using-the-american-national-election-study.html">Using the American National Election Study</a></li>
<li><a class="" href="the-harvard-dataverse.html">The Harvard Dataverse</a></li>
<li><a class="" href="replicating-when-do-politicians-grandstand.html">Replicating “When do politicians grandstand?”</a></li>
<li><a class="" href="data-models-and-evidence-based-policymaking.html"><span class="header-section-number">A</span> Data, models and evidence-based policymaking</a></li>
<li><a class="" href="quasi--and-natural-experiments.html"><span class="header-section-number">B</span> Quasi- and natural experiments</a></li>
<li><a class="" href="matching.html"><span class="header-section-number">C</span> Matching</a></li>
<li><a class="" href="multilevel-and-hierarchical-models.html"><span class="header-section-number">D</span> Multilevel and hierarchical models</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="dynamics-panel-models---a-brief-introduction" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Dynamics panel models - a brief introduction<a class="anchor" aria-label="anchor" href="#dynamics-panel-models---a-brief-introduction"><i class="fas fa-link"></i></a>
</h1>
<div id="plan-for-class" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Plan for class<a class="anchor" aria-label="anchor" href="#plan-for-class"><i class="fas fa-link"></i></a>
</h2>
<p>We will cover four things today:</p>
<ul>
<li>Review - statistical significance - what it means and why it is important</li>
<li>Review - using model coefficients to describe the size of effects
_ What happens when panel data have an ar(1) error term?</li>
<li>Replicating “Democratization and International Border Settlements”</li>
<li>Paper #5</li>
<li>Looking ahead: the Harvard Dataverse (Class example search: Journal of Politics and R)</li>
</ul>
</div>
<div id="review-statistical-significance." class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Review: statistical significance.<a class="anchor" aria-label="anchor" href="#review-statistical-significance."><i class="fas fa-link"></i></a>
</h2>
<p>Statistical significance appeals to the logic of repeated sampling. What does this mean?</p>
<p>We rely on a specific threshold to differentiate between statistically significant and not statistically significant. If p&lt;.05 we consider an effect to be statistically significant - unlikely to be due to chance or the product of sampling error. Why do we use the p&lt;.05 threshold?</p>
<p>So p&gt;.05 and we accept the null hypothesis. What does this mean in practice?</p>
<p>What types of mistakes do we risk making by sticking with this threshold? We should brielfy review the errors that we might confront.</p>
<p><img src="images/Error_types.png" width="90%"><strong>Figure 1. What is a Type I and Type II error?</strong></p>
</div>
<div id="review-using-model-coefficients" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Review: using model coefficients<a class="anchor" aria-label="anchor" href="#review-using-model-coefficients"><i class="fas fa-link"></i></a>
</h2>
<p>In the assignments you are using output from statistical models to evaluate the effects of a variety of conditions on presidential approval, determine what predicts voter turnout, or what makes countries more or less democratic.</p>
<p>When we used logistic regression, we had to use the <code>cplot</code> function to calculate the probability of turnout for various configurations of age, education, income, race and gender. We could see - using several figures - how moving from low to high levels of education increased the probability of turnout and how that effect compared to income or age or race. We used the <code>cplot</code> func since the model was nonlinear and the effect of each X was conditional on the values of the other Xs.</p>
<p>We need to take the same approach to describing the effects of each X in the models we estimate with OLS. Since we are not using `cplot’, this means we need to know something about the actual range of each X in order to explain or understand how much each X matters. In the example last week, the critical variable - settled borders - was a dummy variable, taking only values of zero or one. So the coefficient on that variable - the number in the table - captured the positive effect of having settled borders. Or, in the assignment on presidential approval, the dummy variable for divided government captured the downward pressure on presidential approval under divided government. But using coefficients for other types of variables requires knowing specific things about those variables - the range, maybe the 25th percentile and 75th percentile, or a pair of low and high values that represent something meaningful. You can only make useful comparisons across variables by combining that information with the reported coefficients.</p>
<p>For instance, in the presidential approval dataset, a couple of you used the difference in unemployment as an independent variable. Unemployment was not stationary, so we had to use the first difference What is the typical change in unemployment from one quarter to the next? Using the <code>summary</code> function, we learn this:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb99-1" aria-hidden="true" tabindex="-1"></a>poq<span class="ot">&lt;-</span> <span class="fu">read_dta</span>(<span class="st">"data/poq_guys.dta"</span>)</span>
<span id="cb99-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">diff</span>(poq<span class="sc">$</span>unempl))</span>
<span id="cb99-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb99-3" aria-hidden="true" tabindex="-1"></a>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max.      NA<span class="st">'s </span></span>
<span id="cb99-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="st">-0.966000 -0.200000 -0.034000  0.009542  0.134000  1.667000        17 </span></span></code></pre></div>
<p>So if we want to understand the effect of unemployment on approval, it might make sense to compare how approval would differ between periods where unemployment is rapidly declining (-0.97) vs rapidly growing (1.67). Or we could compare a less dramatic difference - the 25th percentile (-0.200) vs the 75 percentile (0.134).</p>
<p>Say we observe a coefficient in a Partial Adjustment model of -1.18 and an associated long-run effect of (-1.18/(1-0.84))=7.375.</p>
<p>We could say that if we shifted from a period of growing employment (-0.200) to a period of rising unemployment (0.134), that implies a change in x = +0.334. In the short-run, this shift would translate into an decrease 0.334 * 1.18 or only about 0.40 percent. But in the long-run this one time change would eat away 0.334 * 7.375 or about 2.5 points. This seems like a relatively small effect (which helps us understand why this effect was not statistically significant in most cases).</p>
<p>Carefully note the logic here:</p>
<p>Take two representative or theoretically relevant values of X</p>
<p>Subtract <span class="math inline">\(X_1-X_2\)</span></p>
<p>Multiply by the coefficient</p>
<p>This is your effect - always compare effects-to-effects not slope-to-slope</p>
</div>
<div id="what-happens-when-we-have-panel-data-with-serially-correlated-errors" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> What happens when we have panel data with serially correlated errors?<a class="anchor" aria-label="anchor" href="#what-happens-when-we-have-panel-data-with-serially-correlated-errors"><i class="fas fa-link"></i></a>
</h2>
<p>To determine the implications of serial correlation, we will return to the sample data from last week, where we have 2 countries observed over 100 time periods. We were able to use fixed effects to accurately recover the true slope coefficient. The codechunk below replicates that example, but uses an ar(1) error term.</p>
<div class="sourceCode" id="cb100"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Create 400 draws of an error term that is serially correlated rho=0.7</span>

<span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.7</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">3567567</span><span class="op">)</span>
<span class="va">N</span><span class="op">&lt;-</span><span class="fl">400</span>
<span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">N</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co"># AR(1)</span>
<span class="va">e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">N</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span>
  <span class="va">e</span><span class="op">[</span><span class="va">t</span><span class="op">]</span><span class="op">&lt;-</span> <span class="va">rho</span><span class="op">*</span><span class="va">e</span><span class="op">[</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">v</span><span class="op">[</span><span class="va">t</span><span class="op">]</span>
<span class="op">}</span>

<span class="co">#Recreate the example from last week with the new error term</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">10725</span><span class="op">)</span>
<span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">200</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>
<span class="va">e1</span> <span class="op">&lt;-</span> <span class="va">e</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span>
<span class="va">e2</span> <span class="op">&lt;-</span> <span class="va">e</span><span class="op">[</span><span class="fl">201</span><span class="op">:</span><span class="fl">400</span><span class="op">]</span>
<span class="co"># y1 and y2 are the same function of x but different intercept</span>
<span class="co"># In the second regression, x is the same (-2) but the intercept is higher (15)</span>
<span class="va">y1</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">x1</span> <span class="op">+</span> <span class="va">e1</span>
<span class="va">y2</span> <span class="op">&lt;-</span> <span class="fl">15</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">x2</span> <span class="op">+</span> <span class="va">e2</span>

<span class="va">xy</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/append.html">append</a></span><span class="op">(</span><span class="va">y1</span>,<span class="va">y2</span><span class="op">)</span><span class="op">)</span>
<span class="va">xy1</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x1</span>, y<span class="op">=</span><span class="va">y1</span><span class="op">)</span>
<span class="va">xy2</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">x2</span>, y<span class="op">=</span><span class="va">y2</span><span class="op">)</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>data <span class="op">=</span> <span class="va">xy</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, se<span class="op">=</span><span class="cn">FALSE</span>, color<span class="op">=</span><span class="st">"red"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data<span class="op">=</span><span class="va">xy1</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, se<span class="op">=</span><span class="cn">FALSE</span>, color<span class="op">=</span><span class="st">"red"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data<span class="op">=</span><span class="va">xy2</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_smooth</span><span class="op">(</span>method<span class="op">=</span><span class="va">lm</span>, se<span class="op">=</span><span class="cn">FALSE</span>, color<span class="op">=</span><span class="st">"blue"</span>, formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data<span class="op">=</span><span class="va">xy</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>subtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="op">~</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">==</span><span class="op">-</span><span class="fl">2</span><span class="op">~</span><span class="op">~</span><span class="op">~</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/grDevices/plotmath.html">hat</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">[</span><span class="va">blue</span><span class="op">]</span><span class="op">==</span><span class="fl">1.02</span><span class="op">)</span>,
    caption<span class="op">=</span><span class="st">"Figure 2. Comparing true and estimated slope coefficients"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">theme</span><span class="op">(</span>plot.caption.position <span class="op">=</span> <span class="st">"plot"</span>, plot.caption <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0</span>, face<span class="op">=</span><span class="st">"bold"</span>, size<span class="op">=</span><span class="fu">rel</span><span class="op">(</span><span class="fl">1.15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-panel2_files/figure-html/panel_dynamics-1.png" width="672"></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quietly=TRUE suppresses a warning message about conflict with dplyr</span></span>
<span id="cb101-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plm, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb101-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-4" aria-hidden="true" tabindex="-1"></a>Attaching package<span class="sc">:</span> <span class="st">'plm'</span></span>
<span id="cb101-5"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-5" aria-hidden="true" tabindex="-1"></a>The following objects are masked from <span class="st">'package:dplyr'</span><span class="sc">:</span></span>
<span id="cb101-6"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-7" aria-hidden="true" tabindex="-1"></a>    between, lag, lead</span>
<span id="cb101-8"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-8" aria-hidden="true" tabindex="-1"></a><span class="co"># This creates a dataset that is T&gt;N</span></span>
<span id="cb101-9"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-9" aria-hidden="true" tabindex="-1"></a>ccode1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">200</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">200</span>))</span>
<span id="cb101-10"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-10" aria-hidden="true" tabindex="-1"></a>time1<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>,<span class="dv">2</span>))</span>
<span id="cb101-11"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-11" aria-hidden="true" tabindex="-1"></a>data1<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">cbind</span>(ccode1,time1,xy))</span>
<span id="cb101-12"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Like last week, use plm packge to specify panel structure and use tests</span></span>
<span id="cb101-13"><a href="dynamics-panel-models---a-brief-introduction.html#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="fu">pdim</span>(data1, <span class="at">index=</span><span class="fu">c</span>(<span class="st">"ccode1"</span>, <span class="st">"time1"</span>))</span></code></pre></div>
<p>Balanced Panel: n = 2, T = 200, N = 400</p>
<div class="sourceCode" id="cb102"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reg.pooled</span><span class="op">&lt;-</span> <span class="fu">plm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, model<span class="op">=</span><span class="st">"pooling"</span>, data<span class="op">=</span><span class="va">data1</span><span class="op">)</span>
<span class="va">reg.fixed</span><span class="op">&lt;-</span> <span class="fu">plm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span>, model<span class="op">=</span><span class="st">"within"</span>, data<span class="op">=</span><span class="va">data1</span><span class="op">)</span>
<span class="va">reg.pa</span><span class="op">&lt;-</span> <span class="fu">plm</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">x</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, model<span class="op">=</span><span class="st">"within"</span>, data<span class="op">=</span><span class="va">data1</span><span class="op">)</span>
<span class="fu">pbgtest</span><span class="op">(</span><span class="va">reg.fixed</span><span class="op">)</span></code></pre></div>
<pre><code>Breusch-Godfrey/Wooldridge test for serial correlation in panel models</code></pre>
<p>data: y ~ x
chisq = 293.31, df = 200, p-value = 1.876e-05
alternative hypothesis: serial correlation in idiosyncratic errors</p>
<div class="sourceCode" id="cb104"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">stargazer</span><span class="op">(</span><span class="va">reg.pooled</span>, <span class="va">reg.fixed</span>, <span class="va">reg.pa</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span> , digits<span class="op">=</span><span class="fl">2</span>, model.numbers<span class="op">=</span><span class="cn">FALSE</span>, column.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pooled"</span>,<span class="st">"Fixed effects"</span><span class="op">)</span>, dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span>,
title<span class="op">=</span><span class="st">"Table 1. Panel data with serially correlated errors"</span>, notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  omit.stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ser"</span>,<span class="st">"f"</span><span class="op">)</span>, notes.append <span class="op">=</span> <span class="cn">FALSE</span>, star.cutoffs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong>Table 1. Panel data with serially correlated errors</strong>
</caption>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="3">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Pooled
</td>
<td>
Fixed effects
</td>
<td>
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x
</td>
<td>
1.02<sup>**</sup>
</td>
<td>
-1.88<sup>**</sup>
</td>
<td>
-1.91<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.30)
</td>
<td>
(0.07)
</td>
<td>
(0.07)
</td>
</tr>
<tr>
<td style="text-align:left">
lag(y)
</td>
<td>
</td>
<td>
</td>
<td>
0.23<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
(0.03)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
3.32<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.54)
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
400
</td>
<td>
400
</td>
<td>
398
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.03
</td>
<td>
0.64
</td>
<td>
0.69
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.03
</td>
<td>
0.64
</td>
<td>
0.69
</td>
</tr>
<tr>
<td colspan="4" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="4" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
</div>
<div id="replicating-democratization-and-international-border-settlements" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Replicating “Democratization and International Border Settlements”<a class="anchor" aria-label="anchor" href="#replicating-democratization-and-international-border-settlements"><i class="fas fa-link"></i></a>
</h2>
<p>The assignment draws on the dataset used in a 2013 <em>Journal of Politics</em> article that investigated the link between border security and democratization. The code chunk below reads the data and replicates the model that is reported in Table 2, column 2 of that article. You can compare the numbers in the output to the numbers in the paper.</p>
<p>The dependent variable is the <em>Polity 2</em> score for democratization (-10 to 10). Independent variables include:
- trade openness (lagged natural log of exports plus imports)
- settled border
- two measures of military expenditures
- two measures of economic performance
- a lag of the dependent variable (so this is a Partial Adjustment model)</p>
<p>See <span class="citation"><a href="references.html#ref-owsiak2013" role="doc-biblioref">Owsiak</a> (<a href="references.html#ref-owsiak2013" role="doc-biblioref">2013</a>)</span> for details</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Need JOP data</span></span>
<span id="cb105-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb105-2" aria-hidden="true" tabindex="-1"></a>jop<span class="ot">&lt;-</span><span class="fu">read_stata</span>(<span class="st">"data/jop_2013.dta"</span>)</span>
<span id="cb105-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify the dataset as panel data</span></span>
<span id="cb105-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pdim</span>(jop, <span class="at">index=</span><span class="fu">c</span>(<span class="st">"ccode"</span>, <span class="st">"year"</span>))</span>
<span id="cb105-5"><a href="dynamics-panel-models---a-brief-introduction.html#cb105-5" aria-hidden="true" tabindex="-1"></a>Unbalanced Panel<span class="sc">:</span> n <span class="ot">=</span> <span class="dv">200</span>, T <span class="ot">=</span> <span class="dv">2-89</span>, N <span class="ot">=</span> <span class="dv">10434</span></span></code></pre></div>
<p>The dataset includes 200 countries, observed as few as 2 years and as many as 89 years. There are total of 10,434 observations and, since we have different numbers of years for some countries, the data are “unbalanced.”</p>
<p>Last week we learned how to test for unit effects - unmeasured heterogeneity that we capture by permitting each observation to have a unique intercept.</p>
<p>This week we focus on dynamics, how to merge our existing understanding of how to handle time series with what we learned about unit effects.</p>
<p>The strategies for dealing with dynamics in panel models involves starting at the same point as we did with a single unit observed over a long period of time - to test that our series are stationary and to evaluate the residuals of the OLS model for serial correlation.</p>
<div id="testing-for-stationarity" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> Testing for stationarity<a class="anchor" aria-label="anchor" href="#testing-for-stationarity"><i class="fas fa-link"></i></a>
</h3>
<p>You do not need to repeat these tests for your assignment since it is clear all of these series are stationary.</p>
<p>The code cunk below first filters out any cases with missing values for any variable - this is known as “listwise deletion” Beck and Katz discusses alternatives to this approach - missing data imputation. This is where you use some type of algorithm or random draw to fill in missing values for particular variable so you don’t end up deleting an entire observation if only one variable has a missing value. This can also help to balance panel data (filling in gaps so that we have the same time coverage for each unit and the same units at every time)</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This isolates lengths of the series with no missing values.</span></span>
<span id="cb106-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-2" aria-hidden="true" tabindex="-1"></a>jop_test1<span class="ot">&lt;-</span>jop <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>()</span>
<span id="cb106-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This step recreates the data set by adds the index information, clarifying that each observation is a unique combination of country code and year</span></span>
<span id="cb106-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-4" aria-hidden="true" tabindex="-1"></a>panel.set <span class="ot">&lt;-</span> <span class="fu">pdata.frame</span>(jop_test1, <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"ccode"</span>, <span class="st">"year"</span>))</span>
<span id="cb106-5"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#  This is the augmented dickey fuller test from three weeks ago</span></span>
<span id="cb106-6"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#  requires the tseries package</span></span>
<span id="cb106-7"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tseries, <span class="at">quietly=</span><span class="cn">TRUE</span>)</span>
<span id="cb106-8"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>polity2, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-9"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-10" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-11"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-12"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-12" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>polity2</span>
<span id="cb106-13"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-13" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">13.329</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-14"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-14" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-15"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-15" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>allsettle , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-16"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-17"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-17" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-18"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-19"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-19" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>allsettle</span>
<span id="cb106-20"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-20" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">11.411</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-21"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-21" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-22"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-22" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>laggdpam , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-23"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-24"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-24" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-25"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-26"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-26" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>laggdpam</span>
<span id="cb106-27"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-27" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">11.568</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-28"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-28" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-29"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-29" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>lagtradeopen , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-30"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-31"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-31" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-32"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-33"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-33" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>lagtradeopen</span>
<span id="cb106-34"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-34" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">13.872</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-35"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-35" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-36"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-36" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>lagmilex , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-37"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-38"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-38" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-39"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-40"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-40" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>lagmilex</span>
<span id="cb106-41"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-41" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="dv">15</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-42"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-42" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-43"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-43" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>lagmilper , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-44"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-45"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-45" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-46"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-47"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-47" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>lagmilper</span>
<span id="cb106-48"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-48" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">14.377</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-49"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-49" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-50"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-50" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>lagsumdown , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-51"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-52"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-52" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-53"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-54"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-54" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>lagsumdown</span>
<span id="cb106-55"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-55" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">10.962</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-56"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-56" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-57"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-57" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>laggdpchg , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-58"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-59"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-59" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-60"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-61"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-61" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>laggdpchg</span>
<span id="cb106-62"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-62" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">47.521</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-63"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-63" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span>
<span id="cb106-64"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-64" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(panel.set<span class="sc">$</span>lagupop , <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb106-65"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-66"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-66" aria-hidden="true" tabindex="-1"></a>    Augmented Dickey<span class="sc">-</span>Fuller Test</span>
<span id="cb106-67"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-68"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-68" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  panel.set<span class="sc">$</span>lagupop</span>
<span id="cb106-69"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-69" aria-hidden="true" tabindex="-1"></a>Dickey<span class="sc">-</span>Fuller <span class="ot">=</span> <span class="sc">-</span><span class="fl">34.966</span>, Lag order <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="ot">=</span> <span class="fl">0.01</span></span>
<span id="cb106-70"><a href="dynamics-panel-models---a-brief-introduction.html#cb106-70" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> stationary</span></code></pre></div>
<p>In each case above we can reject the null hypothesis. The null is that the series has a unit root and the alternative hypothesis is that the series is stationary. Each series used in the paper is stationary. (Note: the p-values are reported as 0.01. but are rounded up, so many are much lower.)</p>
</div>
<div id="testing-for-serial-correlation" class="section level3" number="8.5.2">
<h3>
<span class="header-section-number">8.5.2</span> Testing for serial correlation<a class="anchor" aria-label="anchor" href="#testing-for-serial-correlation"><i class="fas fa-link"></i></a>
</h3>
<p>We will use the standard BG test for serial correlation. The code chunk below estimates the model without a lagged dependent variable. I don’t report the results, only the test for serial correlation. There are two reported results. The first set ignores the fact that this is panel data, relying on the simple <code>lm</code> function and related tests. The second set of results use the <code>pbgtest</code> from the <strong>plm</strong> package. Given the large number of time points and relatively smaller number of countries, both approaches yield the same result.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-1" aria-hidden="true" tabindex="-1"></a>pooled.ols <span class="ot">&lt;-</span> <span class="fu">lm</span>(polity2<span class="sc">~</span> allsettle<span class="sc">+</span>laggdpam<span class="sc">+</span>laggdpchg<span class="sc">+</span>lagtradeopen<span class="sc">+</span>lagmilper<span class="sc">+</span>lagmilex<span class="sc">+</span>lagupop<span class="sc">+</span>lagsumdown, <span class="at">data=</span>jop, <span class="at">na.action=</span>na.omit)</span>
<span id="cb107-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bgtest</span>(pooled.ols, <span class="at">order=</span><span class="dv">1</span>, <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"Chisq"</span>))</span>
<span id="cb107-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-4" aria-hidden="true" tabindex="-1"></a>    Breusch<span class="sc">-</span>Godfrey test <span class="cf">for</span> serial correlation of order up to <span class="dv">1</span></span>
<span id="cb107-5"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-6"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  pooled.ols</span>
<span id="cb107-7"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-7" aria-hidden="true" tabindex="-1"></a>LM test <span class="ot">=</span> <span class="fl">6430.6</span>, df <span class="ot">=</span> <span class="dv">1</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb107-8"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-9"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-9" aria-hidden="true" tabindex="-1"></a>pooled.plm <span class="ot">&lt;-</span> <span class="fu">plm</span>(polity2<span class="sc">~</span> allsettle<span class="sc">+</span>laggdpam<span class="sc">+</span>laggdpchg<span class="sc">+</span>lagtradeopen<span class="sc">+</span>lagmilper<span class="sc">+</span>lagmilex<span class="sc">+</span>lagupop<span class="sc">+</span>lagsumdown, <span class="at">data=</span>jop, <span class="at">na.action=</span>na.omit, <span class="at">model=</span><span class="st">"pooling"</span>)</span>
<span id="cb107-10"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-10" aria-hidden="true" tabindex="-1"></a><span class="fu">pbgtest</span>(pooled.plm)</span>
<span id="cb107-11"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-12"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-12" aria-hidden="true" tabindex="-1"></a>    Breusch<span class="sc">-</span>Godfrey<span class="sc">/</span>Wooldridge test <span class="cf">for</span> serial correlation <span class="cf">in</span> panel models</span>
<span id="cb107-13"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-14"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-14" aria-hidden="true" tabindex="-1"></a>data<span class="sc">:</span>  polity2 <span class="sc">~</span> allsettle <span class="sc">+</span> laggdpam <span class="sc">+</span> laggdpchg <span class="sc">+</span> lagtradeopen <span class="sc">+</span> lagmilper <span class="sc">+</span>     lagmilex <span class="sc">+</span> lagupop <span class="sc">+</span> lagsumdown</span>
<span id="cb107-15"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-15" aria-hidden="true" tabindex="-1"></a>chisq <span class="ot">=</span> <span class="fl">6433.4</span>, df <span class="ot">=</span> <span class="dv">13</span>, p<span class="sc">-</span>value <span class="sc">&lt;</span> <span class="fl">2.2e-16</span></span>
<span id="cb107-16"><a href="dynamics-panel-models---a-brief-introduction.html#cb107-16" aria-hidden="true" tabindex="-1"></a>alternative hypothesis<span class="sc">:</span> serial correlation <span class="cf">in</span> idiosyncratic errors</span></code></pre></div>
</div>
<div id="a-partial-adjustment-model" class="section level3" number="8.5.3">
<h3>
<span class="header-section-number">8.5.3</span> A partial adjustment model<a class="anchor" aria-label="anchor" href="#a-partial-adjustment-model"><i class="fas fa-link"></i></a>
</h3>
<p>In the paper and in your assignment, we use a partial adjustment model - a lagged value of the dependent variable. This implies a gradual incorporation of a change in X to Y - a partial adjustment in period 1, period 2….and for the long-run.</p>
<p>The code chunk below replicates the results reported in the paper. The second column of numbers matches up with Table 2, Model 2 in the JOP piece.</p>
<div class="sourceCode" id="cb108"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># This models pools the data, ignoring unit heterogeneity.  I estimate and report the coefficients along with 2 sets of standard errors:  conventional, clustered (as reported in the paper),</span>

<span class="co"># This is standard OLS</span>

<span class="va">pooled.pa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">polity2</span><span class="op">~</span> <span class="va">allsettle</span><span class="op">+</span><span class="va">laggdpam</span><span class="op">+</span><span class="va">laggdpchg</span><span class="op">+</span><span class="va">lagtradeopen</span><span class="op">+</span><span class="va">lagmilper</span><span class="op">+</span><span class="va">lagmilex</span><span class="op">+</span><span class="va">lagupop</span><span class="op">+</span><span class="va">lagsumdown</span><span class="op">+</span> <span class="va">lagpolity</span>, data<span class="op">=</span><span class="va">jop</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co">#cov2 is the variance covariance matrix calculated with an adjustment that compensates for the presence of heteroskedasticity,  We have not used this before, so check out the syntax carefully</span>


<span class="va">cluster_se2</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu">vcovCL</span><span class="op">(</span><span class="va">pooled.pa</span>, cluster <span class="op">=</span> <span class="op">~</span> <span class="va">ccode</span>, type <span class="op">=</span> <span class="st">"HC2"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>


<span class="fu">stargazer</span><span class="op">(</span><span class="va">pooled.pa</span>, <span class="va">pooled.pa</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">cluster_se2</span><span class="op">)</span>, column.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Standard"</span>, <span class="st">"Clustered"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"**Table 1. Polity 2 scores as a function of trade, economics, and borders**"</span>, notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append<span class="op">=</span><span class="cn">FALSE</span>, omit.stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ser"</span>,<span class="st">"f"</span><span class="op">)</span>, star.cutoffs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span>, dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Polity democracy score"</span><span class="op">)</span>, covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Trade openness"</span>, <span class="st">"Economic growth"</span>, <span class="st">"Settled borders"</span>, <span class="st">"Constant"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 1. Polity 2 scores as a function of trade, economics, and borders</strong></strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Polity democracy score
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Standard
</td>
<td>
Clustered
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Trade openness
</td>
<td>
0.179<sup>**</sup>
</td>
<td>
0.179<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.048)
</td>
<td>
(0.049)
</td>
</tr>
<tr>
<td style="text-align:left">
Economic growth
</td>
<td>
0.00001
</td>
<td>
0.00001
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.00001)
</td>
<td>
(0.00001)
</td>
</tr>
<tr>
<td style="text-align:left">
Settled borders
</td>
<td>
-0.744<sup>**</sup>
</td>
<td>
-0.744<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.340)
</td>
<td>
(0.378)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.063<sup>**</sup>
</td>
<td>
0.063<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.015)
</td>
<td>
(0.013)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilper
</td>
<td>
-0.00002
</td>
<td>
-0.00002
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0001)
</td>
<td>
(0.0001)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilex
</td>
<td>
-0.000<sup>*</sup>
</td>
<td>
-0.000<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.000)
</td>
<td>
(0.000)
</td>
</tr>
<tr>
<td style="text-align:left">
lagupop
</td>
<td>
-0.029
</td>
<td>
-0.029
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.081)
</td>
<td>
(0.045)
</td>
</tr>
<tr>
<td style="text-align:left">
lagsumdown
</td>
<td>
0.009<sup>**</sup>
</td>
<td>
0.009<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.002)
</td>
<td>
(0.002)
</td>
</tr>
<tr>
<td style="text-align:left">
lagpolity
</td>
<td>
0.962<sup>**</sup>
</td>
<td>
0.962<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.003)
</td>
<td>
(0.005)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.614<sup>**</sup>
</td>
<td>
-0.614<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.099)
</td>
<td>
(0.104)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
7,226
</td>
<td>
7,226
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.944
</td>
<td>
0.944
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.944
</td>
<td>
0.944
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="3" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<p><br>
The results clearly support the expectations outlined in the paper. Nations with settled borders are more democratic. The short-run effect is 0.179 units, but, since this is a partial adjustment model, we know the long-run effect is (0.179)/(1-0.962) or 4.71 units, which is large (almost too large to be believable) on a -10 to 10 scale. Owziak reports in the text the effects over ten periods - how did he calculate that number? And what about the coefficient on lagged military expenditures? What does it mean that a coefficient is negative and significant, but the value of zero? We should talk about why this is not good practice.</p>
<p>There are some warning signs that this specification and approach might be misleading. While trade openness and military expenditures are consistent with our expectation, GDP change is not - higher levels of GDP are associated with lower levels of democratization? And is the coefficient consistent with expectations for previous downward movement in the polity scale? I think, yes, we might see upward movement from very low levels, but that is not explained or clarified in the article. We can also see the democracy score is very persistent, with a coefficient nearing 1.0 so very, very long adjustment processes.</p>
</div>
<div id="what-about-unit-effects" class="section level3" number="8.5.4">
<h3>
<span class="header-section-number">8.5.4</span> What about unit effects?<a class="anchor" aria-label="anchor" href="#what-about-unit-effects"><i class="fas fa-link"></i></a>
</h3>
<p>But so far we appear to be in good shape - the series are stationary, we can add a lagged dependent variable to work with serial correlation. But are there unit effects of the form we discuss last week?</p>
<p>The strategy here is to estimate a model without a lagged dependent variable and compare the results to a model without a lagged dependent variable but adding dummy variables for each country (the least squares dummy variable approach to handling fixed effects).</p>
<div class="sourceCode" id="cb109"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lsdv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">polity2</span><span class="op">~</span> <span class="va">allsettle</span><span class="op">+</span><span class="va">laggdpam</span><span class="op">+</span><span class="va">laggdpchg</span><span class="op">+</span><span class="va">lagtradeopen</span><span class="op">+</span><span class="va">lagmilper</span><span class="op">+</span><span class="va">lagmilex</span><span class="op">+</span><span class="va">lagupop</span><span class="op">+</span><span class="va">lagsumdown</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ccode</span><span class="op">)</span>, data<span class="op">=</span><span class="va">jop</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co">#I used heteroskedasticity-consistent standard errors rather than clustered, since I can't cluster on the countries if I have a dummy variable for each country</span>

<span class="va">cov3</span>         <span class="op">&lt;-</span>    <span class="fu">vcovHC</span><span class="op">(</span><span class="va">lsdv</span>, type <span class="op">=</span> <span class="st">"HC2"</span><span class="op">)</span>
<span class="va">cluster_se3</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">cov3</span><span class="op">)</span><span class="op">)</span>

<span class="fu">stargazer</span><span class="op">(</span><span class="va">lsdv</span>, <span class="va">lsdv</span>, omit<span class="op">=</span><span class="st">"ccode"</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="va">cluster_se3</span><span class="op">)</span>, column.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Standard"</span>, <span class="st">"Consistent"</span><span class="op">)</span>, style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>, title<span class="op">=</span><span class="st">"**Table 1. Polity 2 scores as a function of trade, economics, and borders, fixed effects**"</span>, notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append<span class="op">=</span><span class="cn">FALSE</span>, omit.stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ser"</span>,<span class="st">"f"</span><span class="op">)</span>, star.cutoffs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span>, dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Polity democracy score"</span><span class="op">)</span>, covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Trade openness"</span>, <span class="st">"Economic growth"</span>, <span class="st">"Settled borders"</span>, <span class="st">"Constant"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 1. Polity 2 scores as a function of trade, economics, and borders, fixed effects</strong></strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Polity democracy score
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
Standard
</td>
<td>
Consistent
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Trade openness
</td>
<td>
0.219
</td>
<td>
0.219
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.206)
</td>
<td>
(0.228)
</td>
</tr>
<tr>
<td style="text-align:left">
Economic growth
</td>
<td>
-0.0002<sup>**</sup>
</td>
<td>
-0.0002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.00002)
</td>
<td>
(0.00002)
</td>
</tr>
<tr>
<td style="text-align:left">
Settled borders
</td>
<td>
-0.704
</td>
<td>
-0.704
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.830)
</td>
<td>
(0.823)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
1.715<sup>**</sup>
</td>
<td>
1.715<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.050)
</td>
<td>
(0.054)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilper
</td>
<td>
-0.002<sup>**</sup>
</td>
<td>
-0.002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0003)
</td>
<td>
(0.0003)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilex
</td>
<td>
-0.00000<sup>**</sup>
</td>
<td>
-0.00000<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.000)
</td>
<td>
(0.000)
</td>
</tr>
<tr>
<td style="text-align:left">
lagupop
</td>
<td>
0.536<sup>**</sup>
</td>
<td>
0.536<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.218)
</td>
<td>
(0.318)
</td>
</tr>
<tr>
<td style="text-align:left">
lagsumdown
</td>
<td>
-0.163<sup>**</sup>
</td>
<td>
-0.163<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.011)
</td>
<td>
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-4.619<sup>**</sup>
</td>
<td>
-4.619<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.607)
</td>
<td>
(0.461)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
7,238
</td>
<td>
7,238
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.689
</td>
<td>
0.689
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.683
</td>
<td>
0.683
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="3" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<div class="sourceCode" id="cb110"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">pooled.ols</span>, <span class="va">lsdv</span><span class="op">)</span></code></pre></div>
<p>Analysis of Variance Table</p>
<p>Model 1: polity2 ~ allsettle + laggdpam + laggdpchg + lagtradeopen + lagmilper +
lagmilex + lagupop + lagsumdown
Model 2: polity2 ~ allsettle + laggdpam + laggdpchg + lagtradeopen + lagmilper +
lagmilex + lagupop + lagsumdown + factor(ccode)
Res.Df RSS Df Sum of Sq F Pr(&gt;F)<br>
1 7229 303377<br>
2 7098 125977 131 177400 76.301 &lt; 2.2e-16 ***
—
Signif. codes: 0 ‘<em><strong>’ 0.001 ’</strong>’ 0.01 ’</em>’ 0.05 ‘.’ 0.1 ’ ’ 1</p>
<p>This output indicates the model performance is substantially improved if we add the country dummies. The residual sum of squares - the error - is much lower for model 2, which includes the country factor.</p>
<p>This suggests that perhaps the results published in the JOP piece ignore unmeasured heterogeneity.</p>
</div>
</div>
<div id="using-a-lagged-dependent-variable-with-fixed-effects" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Using a lagged dependent variable with fixed effects<a class="anchor" aria-label="anchor" href="#using-a-lagged-dependent-variable-with-fixed-effects"><i class="fas fa-link"></i></a>
</h2>
<p>There is a well-known bias that is introduced to panel models that contain both unit effects and lagged dependent variable. Labeled, the <em>Nickell bias</em>, due to <span class="citation"><a href="references.html#ref-nickell1981" role="doc-biblioref">Nickell</a> (<a href="references.html#ref-nickell1981" role="doc-biblioref">1981</a>)</span>, the problem is that if you only rely on a short time series (as was the case for most applications of panel studies), then it is impossible to differentiate between unit effects that are passed through to the next time period in the lagged dependent variable and unit effects that show up in the intercept. As a result, the conventional wisdom and firm rule was that lagged dependent variables should never be combined with fixed effects. <span class="citation"><a href="references.html#ref-beckkatz2011" role="doc-biblioref">Beck and Katz</a> (<a href="references.html#ref-beckkatz2011" role="doc-biblioref">2011</a>)</span> demonstrate that this is bad advice: since the size of the bias is related to 1/T - a small T panel (T=3), might have a bias approach 30 percent, but a large T panel (T=90, as we have here) implies a bias of only 1 percent - this bias is acceptable given the tremendous gain we realize - practically (serial correlation) and theoretically (long-term dynamics) if we include a lagged dependent variable.</p>
<p>What happens if we used a lagged Y and control for unit effects? The code chunk below reports the new results and the original output from the paper.</p>
<div class="sourceCode" id="cb111"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">polity2</span><span class="op">~</span> <span class="va">allsettle</span><span class="op">+</span><span class="va">laggdpam</span><span class="op">+</span><span class="va">laggdpchg</span><span class="op">+</span><span class="va">lagtradeopen</span><span class="op">+</span><span class="va">lagmilper</span><span class="op">+</span><span class="va">lagmilex</span><span class="op">+</span><span class="va">lagupop</span><span class="op">+</span><span class="va">lagsumdown</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">ccode</span><span class="op">)</span><span class="op">+</span><span class="va">lagpolity</span>, data<span class="op">=</span><span class="va">jop</span>, na.action<span class="op">=</span><span class="va">na.omit</span><span class="op">)</span>

<span class="co">#I used heteroskedasticity-consistent standard errors rather than clustered, since I can't cluster on the countries if I have a dummy variable for each country</span>

<span class="va">cov4</span>         <span class="op">&lt;-</span>    <span class="fu">vcovHC</span><span class="op">(</span><span class="va">final</span>, type <span class="op">=</span> <span class="st">"HC2"</span><span class="op">)</span>
<span class="va">cluster_se4</span>        <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">cov4</span><span class="op">)</span><span class="op">)</span>

<span class="co">#stargazer(pooled.pa, final, style="qje", type="text", omit="ccode", se = list(cluster_se2, cluster_se4), column.labels=c("As reported", "Fixed effects"))</span>

<span class="fu">stargazer</span><span class="op">(</span><span class="va">pooled.pa</span>, <span class="va">final</span>, omit<span class="op">=</span><span class="st">"ccode"</span>, se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">cluster_se2</span>, <span class="va">cluster_se4</span><span class="op">)</span> ,column.labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"As reported"</span>, <span class="st">"Fixed effects"</span><span class="op">)</span>,  style<span class="op">=</span><span class="st">"apsr"</span>, type<span class="op">=</span><span class="st">"html"</span>, title<span class="op">=</span><span class="st">"**Table 1. Polity 2 scores as a function of trade, economics, and borders, fixed effects**"</span>, notes<span class="op">=</span> <span class="st">"p&lt;.10* ; p&lt;.05**"</span>,  notes.append<span class="op">=</span><span class="cn">FALSE</span>, omit.stat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ser"</span>,<span class="st">"f"</span><span class="op">)</span>, star.cutoffs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.10</span>,<span class="fl">0.05</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">3</span>, dep.var.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Polity democracy score"</span><span class="op">)</span>, covariate.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Trade openness"</span>, <span class="st">"Economic growth"</span>, <span class="st">"Settled borders"</span>, <span class="st">"Constant"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-table"><table style="text-align:center" class="table table-sm">
<caption>
<strong><strong>Table 1. Polity 2 scores as a function of trade, economics, and borders, fixed effects</strong></strong>
</caption>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="2">
Polity democracy score
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
As reported
</td>
<td>
Fixed effects
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Trade openness
</td>
<td>
0.179<sup>**</sup>
</td>
<td>
0.055
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.049)
</td>
<td>
(0.081)
</td>
</tr>
<tr>
<td style="text-align:left">
Economic growth
</td>
<td>
0.00001
</td>
<td>
-0.00002<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.00001)
</td>
<td>
(0.00001)
</td>
</tr>
<tr>
<td style="text-align:left">
Settled borders
</td>
<td>
-0.744<sup>**</sup>
</td>
<td>
-0.793<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.378)
</td>
<td>
(0.413)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
0.063<sup>**</sup>
</td>
<td>
0.136<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.013)
</td>
<td>
(0.019)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilper
</td>
<td>
-0.00002
</td>
<td>
-0.0001
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.0001)
</td>
<td>
(0.0001)
</td>
</tr>
<tr>
<td style="text-align:left">
lagmilex
</td>
<td>
-0.000<sup>**</sup>
</td>
<td>
-0.000
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.000)
</td>
<td>
(0.000)
</td>
</tr>
<tr>
<td style="text-align:left">
lagupop
</td>
<td>
-0.029
</td>
<td>
0.006
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.045)
</td>
<td>
(0.043)
</td>
</tr>
<tr>
<td style="text-align:left">
lagsumdown
</td>
<td>
0.009<sup>**</sup>
</td>
<td>
0.026<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.002)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
lagpolity
</td>
<td>
0.962<sup>**</sup>
</td>
<td>
0.918<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.005)
</td>
<td>
(0.007)
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
-0.614<sup>**</sup>
</td>
<td>
-0.299<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.104)
</td>
<td>
(0.138)
</td>
</tr>
<tr>
<td style="text-align:left">
N
</td>
<td>
7,226
</td>
<td>
7,226
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.944
</td>
<td>
0.946
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.944
</td>
<td>
0.945
</td>
</tr>
<tr>
<td colspan="3" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td colspan="3" style="text-align:left">
p&lt;.10* ; p&lt;.05**
</td>
</tr>
</table></div>
<p><br></p>
</div>
<div id="one-other-detail" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> One other detail<a class="anchor" aria-label="anchor" href="#one-other-detail"><i class="fas fa-link"></i></a>
</h2>
<p>The panel models describe last week hinge on an assumption that can be difficult to sustain and evaluate: <em>strict exogeneity</em>. This means that the error in the past or in future is uncorrelated with current value of X. A variety of mechanisms could violate this assumption.</p>
<p>Feedback - where values of Y today lead to changes in X in the future. Consider our running example - could democratic nations experience higher levels of economic growth, or more trade openness? This a specific example of a broader problem called <em>simultaneity bias</em></p>
<p>There is straight forward way to test for strict exogeneity if you are using fixed effects. Just add future values of X to the model. If there is no feedback, this information should not be significant.</p>
<p>You can see below that we have feedback in this case. Democratization at time t is consistent with trade openness at time t+1</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-1" aria-hidden="true" tabindex="-1"></a>se.model <span class="ot">&lt;-</span> <span class="fu">plm</span>(polity2 <span class="sc">~</span> lagtradeopen <span class="sc">+</span> laggdpchg <span class="sc">+</span><span class="fu">lead</span>(lagtradeopen, <span class="at">k=</span><span class="dv">2</span>), <span class="at">data=</span>jop, <span class="at">index=</span><span class="fu">c</span>(<span class="st">"ccode"</span>, <span class="st">"year"</span>), <span class="at">na.action=</span>na.omit, <span class="at">model=</span><span class="st">"within"</span>)</span>
<span id="cb112-2"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(se.model)</span>
<span id="cb112-4"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Oneway</span> (individual) effect Within Model</span>
<span id="cb112-5"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-6" aria-hidden="true" tabindex="-1"></a>Call<span class="sc">:</span></span>
<span id="cb112-7"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plm</span>(<span class="at">formula =</span> polity2 <span class="sc">~</span> lagtradeopen <span class="sc">+</span> laggdpchg <span class="sc">+</span> <span class="fu">lead</span>(lagtradeopen, </span>
<span id="cb112-8"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">2</span>), <span class="at">data =</span> jop, <span class="at">na.action =</span> na.omit, <span class="at">model =</span> <span class="st">"within"</span>, </span>
<span id="cb112-9"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"ccode"</span>, <span class="st">"year"</span>))</span>
<span id="cb112-10"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-11"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-11" aria-hidden="true" tabindex="-1"></a>Unbalanced Panel<span class="sc">:</span> n <span class="ot">=</span> <span class="dv">154</span>, T <span class="ot">=</span> <span class="dv">1-85</span>, N <span class="ot">=</span> <span class="dv">7546</span></span>
<span id="cb112-12"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-13" aria-hidden="true" tabindex="-1"></a>Residuals<span class="sc">:</span></span>
<span id="cb112-14"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-14" aria-hidden="true" tabindex="-1"></a>     Min.   1st Qu.    Median   3rd Qu.      Max. </span>
<span id="cb112-15"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-15" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span><span class="fl">14.44631</span>  <span class="sc">-</span><span class="fl">2.68323</span>  <span class="sc">-</span><span class="fl">0.28629</span>   <span class="fl">2.44581</span>  <span class="fl">16.89374</span> </span>
<span id="cb112-16"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-17"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-17" aria-hidden="true" tabindex="-1"></a>Coefficients<span class="sc">:</span></span>
<span id="cb112-18"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-18" aria-hidden="true" tabindex="-1"></a>                          Estimate Std. Error t<span class="sc">-</span>value  <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>t<span class="sc">|</span>)    </span>
<span id="cb112-19"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-19" aria-hidden="true" tabindex="-1"></a>lagtradeopen               <span class="fl">0.54497</span>    <span class="fl">0.13211</span>  <span class="fl">4.1250</span> <span class="fl">3.748e-05</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb112-20"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-20" aria-hidden="true" tabindex="-1"></a>laggdpchg                 <span class="sc">-</span><span class="fl">2.17641</span>    <span class="fl">0.79086</span> <span class="sc">-</span><span class="fl">2.7520</span> <span class="fl">0.0059384</span> <span class="sc">**</span> </span>
<span id="cb112-21"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lead</span>(lagtradeopen, <span class="at">k =</span> <span class="dv">2</span>)  <span class="fl">0.48102</span>    <span class="fl">0.13086</span>  <span class="fl">3.6758</span> <span class="fl">0.0002388</span> <span class="sc">**</span><span class="er">*</span></span>
<span id="cb112-22"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-22" aria-hidden="true" tabindex="-1"></a><span class="sc">---</span></span>
<span id="cb112-23"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-23" aria-hidden="true" tabindex="-1"></a>Signif. codes<span class="sc">:</span>  <span class="dv">0</span> <span class="st">'***'</span> <span class="fl">0.001</span> <span class="st">'**'</span> <span class="fl">0.01</span> <span class="st">'*'</span> <span class="fl">0.05</span> <span class="st">'.'</span> <span class="fl">0.1</span> <span class="st">' '</span> <span class="dv">1</span></span>
<span id="cb112-24"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-25"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-25" aria-hidden="true" tabindex="-1"></a>Total Sum of Squares<span class="sc">:</span>    <span class="dv">152510</span></span>
<span id="cb112-26"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-26" aria-hidden="true" tabindex="-1"></a>Residual Sum of Squares<span class="sc">:</span> <span class="dv">131380</span></span>
<span id="cb112-27"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-27" aria-hidden="true" tabindex="-1"></a>R<span class="sc">-</span>Squared<span class="sc">:</span>      <span class="fl">0.13857</span></span>
<span id="cb112-28"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-28" aria-hidden="true" tabindex="-1"></a>Adj. R<span class="sc">-</span>Squared<span class="sc">:</span> <span class="fl">0.12038</span></span>
<span id="cb112-29"><a href="dynamics-panel-models---a-brief-introduction.html#cb112-29" aria-hidden="true" tabindex="-1"></a>F<span class="sc">-</span>statistic<span class="sc">:</span> <span class="fl">396.198</span> on <span class="dv">3</span> and <span class="dv">7389</span> DF, p<span class="sc">-</span>value<span class="sc">:</span> <span class="er">&lt;</span> <span class="fl">2.22e-16</span></span></code></pre></div>
<p><br>
## What about feasible generalized least squares approaches?</p>
<p>If you read the literature in political science, especially 1985-95, you will see most statistical treatments of panel data use generalized least square or GLS. <span class="citation"><a href="references.html#ref-beckkatz1995" role="doc-biblioref">Beck and Katz</a> (<a href="references.html#ref-beckkatz1995" role="doc-biblioref">1995</a>)</span> note that it is inappropriate to use GLS estimators if T is not much larger than N. You can, of course, estimate this model with the data above (where T is less than 100 and N is 200). But the output is consistent with the problem identified by Beck and Katz. The standard errors for the coefficients are much too low.</p>
<div id="things-i-did-not-have-time-to" class="section level3" number="8.7.1">
<h3>
<span class="header-section-number">8.7.1</span> Things I did not have time to<a class="anchor" aria-label="anchor" href="#things-i-did-not-have-time-to"><i class="fas fa-link"></i></a>
</h3>
<div id="panel-corrected-standard-errors-compared-to-cluster-using-the-plm-package" class="section level4" number="8.7.1.1">
<h4>
<span class="header-section-number">8.7.1.1</span> Panel-corrected standard errors compared to cluster using the plm package<a class="anchor" aria-label="anchor" href="#panel-corrected-standard-errors-compared-to-cluster-using-the-plm-package"><i class="fas fa-link"></i></a>
</h4>

<!-- Needs the MASS library -->
<!-- Uses the ANES -->
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="working-with-panel-data.html"><span class="header-section-number">7</span> Working with panel data</a></div>
<div class="next"><a href="counts.html"><span class="header-section-number">9</span> Counts</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#dynamics-panel-models---a-brief-introduction"><span class="header-section-number">8</span> Dynamics panel models - a brief introduction</a></li>
<li><a class="nav-link" href="#plan-for-class"><span class="header-section-number">8.1</span> Plan for class</a></li>
<li><a class="nav-link" href="#review-statistical-significance."><span class="header-section-number">8.2</span> Review: statistical significance.</a></li>
<li><a class="nav-link" href="#review-using-model-coefficients"><span class="header-section-number">8.3</span> Review: using model coefficients</a></li>
<li><a class="nav-link" href="#what-happens-when-we-have-panel-data-with-serially-correlated-errors"><span class="header-section-number">8.4</span> What happens when we have panel data with serially correlated errors?</a></li>
<li>
<a class="nav-link" href="#replicating-democratization-and-international-border-settlements"><span class="header-section-number">8.5</span> Replicating “Democratization and International Border Settlements”</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#testing-for-stationarity"><span class="header-section-number">8.5.1</span> Testing for stationarity</a></li>
<li><a class="nav-link" href="#testing-for-serial-correlation"><span class="header-section-number">8.5.2</span> Testing for serial correlation</a></li>
<li><a class="nav-link" href="#a-partial-adjustment-model"><span class="header-section-number">8.5.3</span> A partial adjustment model</a></li>
<li><a class="nav-link" href="#what-about-unit-effects"><span class="header-section-number">8.5.4</span> What about unit effects?</a></li>
</ul>
</li>
<li><a class="nav-link" href="#using-a-lagged-dependent-variable-with-fixed-effects"><span class="header-section-number">8.6</span> Using a lagged dependent variable with fixed effects</a></li>
<li>
<a class="nav-link" href="#one-other-detail"><span class="header-section-number">8.7</span> One other detail</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#things-i-did-not-have-time-to"><span class="header-section-number">8.7.1</span> Things I did not have time to</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Political Science and Applied Statistics using R</strong>" was written by J.K. Corder. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
